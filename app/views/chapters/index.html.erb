

<p id="notice"><%= notice %></p>

<h1>Listing Books</h1>

<div class="row">
  <div class="col-md-8">
<%= form_tag chapters_path, method: :get do %>
    <p>
    <form class="form-inline">
      <div class="form-group">
        <%= text_field_tag :q, params[:q], class:"form-control" %>
      </div>
      <%= submit_tag "Search", name: nil, class:"btn btn-success" %>
    </form>
    </p>
<% end %>
<br>

<table class="table">
  <thead>
  <tr>
    <th>Title</th>
    <th>Description</th>
    <th>content</th>
    <th>Updated</th>
    <th>Inspect</th>
    <th colspan="3"></th>
  </tr>
  </thead>

  <tbody>
  <% @chapters.results.each do |c| %>
      <tr>
        <td><%= c.title %></td>
        <td><%= c.description %></td>
        <td><%= c.content %></td>
        <td><%= c.updated_at %></td>
        <td><%= c.inspect %></td>
      </tr>
  <% end %>
  </tbody>
</table>

<br>
    <%= paginate @chapters  %>

</div>
  <div class="col-md-4">
  <% @chapters.response.response.facets.each do |facet,facet_data| %>
      <div class='form-group'>
        <label><%= ActiveSupport::Inflector.humanize(facet) %></label>
        <select class='form-control facet_select' size='5' name="search[<%= facet %>][]" multiple>
          <% facet_data.terms.each do |f| %>
              <% selected = (params[:search].present? && params[:search][facet].present? && params[:search][facet].include?(f[:term].to_s)) ? true : false %>
              <option data-selected="<%= selected %>" value="<%= f[:term] %>" <%= selected ? "selected" : "" %> >
                <%= f[:term] %>
                (<%= f[:count] %>)
              </option>
          <% end %>
        </select>
      </div>
  <% end %>
    </div>
</div>

